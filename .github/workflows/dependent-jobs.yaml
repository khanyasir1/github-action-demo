name: GitHub Dependent-Job Demo
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€

on: 
  push:
    branches:
      - main  # Trigger only on pushes to the main branch

jobs:
  setup:
    runs-on: ubuntu-20.04  # Explicit runner version
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Make setup script executable
        run: chmod +x ./setup_server.sh
      - name: Run setup script
        run: ./setup_server.sh

  build:
    needs: setup
    runs-on: ubuntu-20.04
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Make build script executable
        run: chmod +x ./build_server.sh
      - name: Run build script
        run: ./build_server.sh

  test:
    needs: build
    runs-on: ubuntu-20.04
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Make test script executable
        run: chmod +x ./test_server.sh
      - name: Run test script
        run: ./test_server.sh
